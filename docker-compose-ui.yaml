services:
  nginx-ui-reverse-proxy:
    image: nginx
    ports:
      - 80:80
      - 443:443
    volumes:
      - ./nginx/ui.conf:/etc/nginx/conf.d/default.conf
      - ./cert.pem:/etc/ssl/certs/cert.pem
      - ./key.pem:/etc/ssl/certs/key.pem

  host-multichat-ui:
    build:
      context: .
      dockerfile: docker/web/Dockerfile.dev
      args:
        - SERVICE_DIR=hosts/multichat
    env_file:
      - .env.dev
    environment:
      - VITE_SERVICE_TYPE=ui
      - VITE_SERVICE_NAME=multichat
      - VITE_SERVICE_VERSION=v1
      - VITE_SERVICE_ID=multichat.ui
      - VITE_SERVICE_DB_SCHEMA=multichat

      - UI_DEPENDENCY_AUTH=http://localhost/ui/v1/auth/remoteEntry.js
      - UI_DEPENDENCY_CHAT=http://localhost/ui/v1/chat/remoteEntry.js
    volumes:
      - ./src/web/apps/hosts/multichat:/app/apps/hosts/multichat

  remote-auth-ui:
    build:
      context: .
      dockerfile: docker/web/Dockerfile.dev
      args:
        - SERVICE_DIR=remotes/auth
    env_file:
      - .env.dev
    environment:
      - VITE_SERVICE_TYPE=ui
      - VITE_SERVICE_NAME=auth
      - VITE_SERVICE_VERSION=v1
      - VITE_SERVICE_ID=auth.ui
      - VITE_SERVICE_DB_SCHEMA=auth
    volumes:
      - ./src/web/apps/remotes/auth:/app/apps/remotes/auth

  remote-chat-ui:
    build:
      context: .
      dockerfile: docker/web/Dockerfile.dev
      args:
        - SERVICE_DIR=remotes/chat
    env_file:
      - .env.dev
    environment:
      - VITE_SERVICE_TYPE=ui
      - VITE_SERVICE_NAME=chat
      - VITE_SERVICE_VERSION=v1
      - VITE_SERVICE_ID=chat.ui
      - VITE_SERVICE_DB_SCHEMA=chat
    volumes:
      - ./src/web/apps/remotes/chat:/app/apps/remotes/chat

networks:
  shared-net:
    name: net
